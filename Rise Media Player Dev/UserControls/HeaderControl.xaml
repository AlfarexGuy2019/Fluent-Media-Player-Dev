<UserControl
    x:Name="Root"
    x:Class="Rise.App.UserControls.HeaderControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:animations="using:Microsoft.Toolkit.Uwp.UI.Animations"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:common="using:Rise.App.Common"
    xmlns:converters="using:Rise.App.Converters"
    xmlns:local="using:Rise.App.UserControls"
    xmlns:viewmodels="using:Rise.App.ViewModels"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400">

    <UserControl.Resources>
        <ResourceDictionary>
            <converters:NullToBoolean x:Key="NullToBool" />

            <local:HeaderTemplateSelector x:Key="HeaderTemplate">
                <local:HeaderTemplateSelector.AlbumTemplate>
                    <DataTemplate x:DataType="viewmodels:AlbumViewModel">
                        <Grid ColumnSpacing="24" Padding="12,0,12,32">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="154" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>

                            <Border animations:Connected.Key="Art"
                                    CornerRadius="8">
                                <Image Height="154"
                                       Stretch="Uniform"
                                       Width="154">
                                    <Image.Source>
                                        <BitmapImage UriSource="{x:Bind Thumbnail}" />
                                    </Image.Source>
                                </Image>
                            </Border>

                            <StackPanel Grid.Column="1"
                                        Orientation="Vertical"
                                        Spacing="8"
                                        VerticalAlignment="Center">
                                <Grid ColumnSpacing="4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="1*" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="{x:Bind Title}"
                                           MaxLines="1"
                                           Style="{StaticResource TitleTextBlockStyle}"
                                           VerticalAlignment="Center"
                                           TextTrimming="CharacterEllipsis" />

                                    <FontIcon Grid.Column="1"
                                              FontSize="20"
                                              Foreground="{ThemeResource ApplicationSecondaryForegroundThemeBrush}"
                                              Glyph="&#xF12B;"
                                              Margin="0,6,0,0"
                                              VerticalAlignment="Center" />

                                    <!--ToggleButton Grid.Column="1"
                                                  Background="Transparent"
                                                  BorderThickness="0"
                                                  Height="32"
                                                  Padding="0"
                                                  Width="32">
                                        <FontIcon FontSize="16" Glyph="&#xE19F;" />
                                    </ToggleButton>

                                    <ToggleButton Grid.Column="2"
                                                  Background="Transparent"
                                                  BorderThickness="0"
                                                  Height="32"
                                                  Padding="0"
                                                  Width="32">
                                        <FontIcon FontSize="16" Glyph="&#xE19E;" />
                                    </ToggleButton-->
                                </Grid>

                                <TextBlock FontWeight="SemiBold" Style="{StaticResource BodyTextBlockStyle}">
                                    <Hyperlink Click="Hyperlink_Click" UnderlineStyle="None">
                                        <Run Text="{x:Bind Artist}" />
                                    </Hyperlink>
                                </TextBlock>

                                <TextBlock Text="{x:Bind Genres}"
                                           MaxLines="1"
                                           Style="{StaticResource BodyTextBlockStyle}" />

                                <CommandBar Background="Transparent"
                                            DefaultLabelPosition="Right"
                                            HorizontalAlignment="Left"
                                            Margin="-12,0">
                                    <AppBarButton x:Uid="/Information/Play"
                                                  Command="{Binding ElementName=Root, Path=PlayCommand}"
                                                  Icon="Play"
                                                  Style="{StaticResource AppBarCompactButton}" />

                                    <AppBarSeparator />

                                    <AppBarButton x:Uid="/Information/Shuffle"
                                                  Command="{Binding ElementName=Root, Path=ShuffleCommand}"
                                                  Icon="Shuffle" />
                                    <AppBarButton x:Uid="/Information/Add" IsEnabled="False" IsCompact="True">
                                        <AppBarButton.Icon>
                                            <FontIcon Glyph="&#xECC8;" />
                                        </AppBarButton.Icon>

                                        <AppBarButton.Flyout>
                                            <MenuFlyout>
                                                <MenuFlyoutItem Text="Playlist">
                                                    <MenuFlyoutItem.Icon>
                                                        <FontIcon Glyph="&#xE142;" />
                                                    </MenuFlyoutItem.Icon>
                                                </MenuFlyoutItem>
                                            </MenuFlyout>
                                        </AppBarButton.Flyout>
                                    </AppBarButton>

                                    <AppBarSeparator />

                                    <AppBarButton x:Uid="/Information/Delete"
                                                  Icon="Delete"
                                                  IsEnabled="False"
                                                  Style="{StaticResource AppBarCompactButton}" />
                                    <AppBarButton x:Uid="/Information/Edit"
                                                  Command="{Binding ElementName=Root, Path=EditCommand}"
                                                  Icon="Edit"
                                                  Style="{StaticResource AppBarCompactButton}" />
                                </CommandBar>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </local:HeaderTemplateSelector.AlbumTemplate>

                <local:HeaderTemplateSelector.GenreTemplate>
                    <DataTemplate x:DataType="viewmodels:GenreViewModel">
                        <Grid ColumnSpacing="24" Padding="12,0,12,32">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="154" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>

                            <Border animations:Connected.Key="Art"
                                    CornerRadius="8">
                                <Image Height="154"
                                       Stretch="UniformToFill"
                                       Width="154">
                                    <Image.Source>
                                        <BitmapImage UriSource="ms-appx:///Assets/Default.png" />
                                    </Image.Source>
                                </Image>
                            </Border>

                            <StackPanel Grid.Column="1"
                                        Orientation="Vertical"
                                        Spacing="8">
                                <TextBlock Text="{x:Bind Name}"
                                           MaxLines="1"
                                           Style="{StaticResource TitleTextBlockStyle}" />

                                <CommandBar Background="Transparent"
                                            DefaultLabelPosition="Right"
                                            HorizontalAlignment="Left"
                                            Margin="-12,0">
                                    <AppBarButton x:Uid="/Information/Play"
                                                  Command="{Binding ElementName=Root, Path=PlayCommand}"
                                                  Icon="Play"
                                                  Style="{StaticResource AppBarCompactButton}" />

                                    <AppBarSeparator />

                                    <AppBarButton x:Uid="/Information/Shuffle"
                                                  Command="{Binding ElementName=Root, Path=ShuffleCommand}"
                                                  Icon="Shuffle" />
                                    <AppBarButton x:Uid="/Information/Add" IsEnabled="False" IsCompact="True">
                                        <AppBarButton.Icon>
                                            <FontIcon Glyph="&#xECC8;" />
                                        </AppBarButton.Icon>

                                        <AppBarButton.Flyout>
                                            <MenuFlyout>
                                                <MenuFlyoutItem Text="Playlist">
                                                    <MenuFlyoutItem.Icon>
                                                        <FontIcon Glyph="&#xE142;" />
                                                    </MenuFlyoutItem.Icon>
                                                </MenuFlyoutItem>
                                            </MenuFlyout>
                                        </AppBarButton.Flyout>
                                    </AppBarButton>

                                    <AppBarSeparator />

                                    <AppBarButton x:Uid="/Information/Delete"
                                                  Icon="Delete"
                                                  IsEnabled="False"
                                                  Style="{StaticResource AppBarCompactButton}" />
                                    <AppBarButton x:Uid="/Information/Edit"
                                                  Command="{Binding ElementName=Root, Path=EditCommand}"
                                                  Icon="Edit"
                                                  Style="{StaticResource AppBarCompactButton}" />

                                    <AppBarSeparator />

                                    <!--AppBarButton x:Uid="/Information/View">
                                        <AppBarButton.Icon>
                                            <FontIcon Glyph="&#xECAA;" />
                                        </AppBarButton.Icon>

                                        <AppBarButton.Flyout>
                                            <MenuFlyout>
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Songs"
                                                                          Command="{Binding ElementName=Root, Path=ViewCommand}"
                                                                          CommandParameter="Default"
                                                                          GroupName="View" />
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Artists"
                                                                          Command="{Binding ElementName=Root, Path=ViewCommand}"
                                                                          CommandParameter="Artists"
                                                                          GroupName="View" />
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Albums"
                                                                          Command="{Binding ElementName=Root, Path=ViewCommand}"
                                                                          CommandParameter="Albums"
                                                                          GroupName="View" />
                                            </MenuFlyout>
                                        </AppBarButton.Flyout>
                                    </AppBarButton-->

                                    <AppBarButton x:Uid="/Information/Sort"
                                                  Icon="Sort">
                                        <AppBarButton.Flyout>
                                            <MenuFlyout>
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Track"
                                                                          Command="{Binding ElementName=Root, Path=SortCommand}"
                                                                          CommandParameter="Track" />
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Title"
                                                                          Command="{Binding ElementName=Root, Path=SortCommand}"
                                                                          CommandParameter="Title"
                                                                          IsChecked="True" />
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Genre"
                                                                          Command="{Binding ElementName=Root, Path=SortCommand}"
                                                                          CommandParameter="Genres" />
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Year"
                                                                          Command="{Binding ElementName=Root, Path=SortCommand}"
                                                                          CommandParameter="Year" />

                                                <MenuFlyoutSeparator />

                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Ascending"
                                                                          Command="{Binding ElementName=Root, Path=SortCommand}"
                                                                          CommandParameter="Ascending"
                                                                          GroupName="Descending"
                                                                          IsChecked="True" />
                                                <muxc:RadioMenuFlyoutItem x:Uid="/Information/Descending"
                                                                          Command="{Binding ElementName=Root, Path=SortCommand}"
                                                                          CommandParameter="Descending"
                                                                          GroupName="Descending" />
                                            </MenuFlyout>
                                        </AppBarButton.Flyout>
                                    </AppBarButton>
                                </CommandBar>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </local:HeaderTemplateSelector.GenreTemplate>
            </local:HeaderTemplateSelector>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <common:CompositionControl Content="{x:Bind HeaderModel, Mode=OneWay}"
                                   ContentTemplateSelector="{StaticResource HeaderTemplate}" />
    </Grid>
</UserControl>
